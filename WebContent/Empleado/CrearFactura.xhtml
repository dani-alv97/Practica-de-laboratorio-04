<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76"
		href="/PracticaDeLaboratorio04/assets/img/apple-icon.png" />
	<link rel="icon" type="image/png"
		href="/PracticaDeLaboratorio04/assets/img/favicon.png" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>Factura</title>
	<meta
		content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
		name='viewport' />
	<!--     Fonts and icons     -->
	<link
		href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200"
		rel="stylesheet" />
	<link rel="stylesheet"
		href="https://use.fontawesome.com/releases/v5.7.1/css/all.css"
		integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
		crossorigin="anonymous" />
	<link
		href="/PracticaDeLaboratorio04/assets/css/bootstrap.min.css"
		rel="stylesheet" />
	<link
		href="/PracticaDeLaboratorio04/assets/css/now-ui-dashboard.css?v=1.5.0"
		rel="stylesheet" />
</h:head>
<h:body>
	<div class="wrapper ">
		<div class="main-panel" id="main-panel" style="width: calc(100%)">
			<!-- Navbar -->
			<h:form id="formGestionClientes">
				<nav
					class="navbar navbar-expand-lg navbar-transparent  bg-primary  navbar-absolute">
				<div class="container-fluid">
					<div class="navbar-wrapper">
						<div class="navbar-toggle">
							<button type="button" class="navbar-toggler">
								<span class="navbar-toggler-bar bar1"></span> <span
									class="navbar-toggler-bar bar2"></span> <span
									class="navbar-toggler-bar bar3"></span>
							</button>
						</div>
						<a class="navbar-brand" href="#Floro">Empleado - Crear Factura</a>
					</div>
					<button class="navbar-toggler" type="button" data-toggle="collapse"
						data-target="#navigation" aria-controls="navigation-index"
						aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-bar navbar-kebab"></span> <span
							class="navbar-toggler-bar navbar-kebab"></span> <span
							class="navbar-toggler-bar navbar-kebab"></span>
					</button>
					<div class="collapse navbar-collapse justify-content-end"
						id="navigation">
						<ul class="navbar-nav">
						  <li class="nav-item">
                                    <h:commandLink class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" value="Gestionar Pedidos" action="#{navigator.reglaRedir('GestionarPedidos')}"></h:commandLink>
                                </li>
							<li class="nav-item dropdown"><a
								class="nav-link dropdown-toggle" id="navbarDropdownMenuLink"
								data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false"> <i>Gestionar Facturas </i>
							</a>
								<div class="dropdown-menu dropdown-menu-right"
									aria-labelledby="navbarDropdownMenuLink">
									<h:commandLink class="dropdown-item" value="Crear Factura"
										action="#{navigator.reglaRedir('CreacionFactura')}" />
									<h:commandLink class="dropdown-item" value="Listar Facturas"
										action="#{navigator.reglaRedir('listarFactura')}" />
								</div></li>
							<li class="nav-item dropdown"><a
								class="nav-link dropdown-toggle" id="navbarDropdownMenuLink"
								data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false"> <i>Gestionar Clientes </i>
							</a>
								<div class="dropdown-menu dropdown-menu-right"
									aria-labelledby="navbarDropdownMenuLink">
									<h:commandLink class="dropdown-item" value="Crear Cliente"
										action="#{navigator.reglaRedir('crearCliente')}" />
									<h:commandLink class="dropdown-item" value="Listar Clientes"
										action="#{navigator.reglaRedir('listarClientes')}" />
								</div></li>
							<li class="nav-item"><h:commandLink class="dropdown-item"
									action="#{navigator.reglaRedir('salir')}">
									<i class="now-ui-icons media-1_button-power"></i>
								</h:commandLink></li>
						</ul>
					</div>
				</div>
				</nav>
			</h:form>
			<!-- End Navbar -->
			<div class="panel-header panel-header-sm"></div>
			<div class="content">

				<div class="row">

					<div class="col-md-6">

						<div class="card  card-tasks">

							<div class="card-body ">
								<h:form id="fa1">
									<div id="buscarProdFac">
										<h3 class="card-category" style="text-align: center;">Buscar Producto Nombre</h3>
										<p:inputText class="form-control" id="nombreBuscar"
											value="#{productoBean.nombreBusq}" type="text"></p:inputText>
										<p:commandButton class="btn btn-primary btn-block"
											style="background: Black;font-family: sans-serif;"
											value="Buscar" action="#{productoBean.buscarPorNombre}"
											update="fa1">
										</p:commandButton>
										<p></p>
									</div>
									<div id="contenedorProductos">
										<p:dataTable id="tablaProd" value="#{productoBean.pedidos}"
											var="ped" headerClass="cabeceraTabla"
											rowClasses="filaPar,filaImpar">
											<p:column headerText="Id">
												<h:outputText value="#{ped.producto.id}" />
											</p:column>
											<p:column headerText="Nombre">
												<h:outputText value="#{ped.producto.nombre}" />
											</p:column>
											<p:column headerText="Stock">
												<h:outputText value="#{ped.producto.stock}" />
											</p:column>
											<p:column headerText="Bodega">
												<h:outputText value="#{ped.producto.bodegas.get(0).nombre}" />
											</p:column>
											<p:column headerText="Cantidad a Pedir">
												<p:inputText class="form-control" id="cantidad"
													name="header" value="#{ped.cantidad}" type="text"></p:inputText>
											</p:column>
											<p:column headerText="Agregar Producto">
												<p:commandButton class="btn-primary" value="Agregar"
													actionListener="#{facturaDetalleBean.addDetallesFac(ped)}"
													update="fa1 fa3">
												</p:commandButton>
											</p:column>
										</p:dataTable>
									</div>
								</h:form>
							</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class="card">
							
							<div class="card-body">
								<div id="contenedorFactura">
									<h:form id="fa2">
										<h3 class="card-category" style="text-align: center;" >Buscar Cliente</h3>
										<p></p>
										<h:inputText class="form-control" id="cedulaBuscar"
											value="#{personaBean.cedula}" type="text"></h:inputText>
										<h:commandButton class="btn btn-primary btn-block"
											value="Buscar Cliente"
											style="background: Black;font-family: sans-serif;"
											action="#{personaBean.buscarPersonaCedula}">
											<f:ajax execute="cedulaBuscar"
												render="salidaNombre salidaApellido salidaCedula salidaTelefono salidaDireccion" />
										</h:commandButton>
										<p></p>
										<h:outputLabel for="salidaNombre" value="Nombre:"></h:outputLabel>
										<h:inputText class="form-control" id="salidaNombre"
											value="#{personaBean.nombre}"></h:inputText>
										<p></p>
										<h:outputLabel for="salidaApellido" value="Apellido:"></h:outputLabel>
										<h:inputText class="form-control" id="salidaApellido"
											value="#{personaBean.apellido}"></h:inputText>
										<p></p>
										<h:outputLabel for="salidaTelefono" value="Telefono:"></h:outputLabel>
										<h:inputText class="form-control" id="salidaTelefono"
											value="#{personaBean.telefono}"></h:inputText>
										<p></p>
										<h:outputLabel for="salidaDireccion" value="Direccion:"></h:outputLabel>
										<h:inputText class="form-control" id="salidaDireccion"
											value="#{personaBean.direccion}"></h:inputText>
										<p></p>
									</h:form>
									<h:form id="fa3">
										<div id="detalleFactura">
											<p:dataTable id="tablaDetalle"
												value="#{facturaDetalleBean.detallesFac}" var="detalle"
												styleClass="tabla" headerClass="cabeceraTabla"
												rowClasses="filaPar,filaImpar">
												<p:column>
													<f:facet name="header" id="prodId">Producto</f:facet>#{detalle.producto.nombre}
                                                </p:column>
												<p:column>
													<f:facet name="header" id="prodNombre">Precio</f:facet>#{detalle.producto.precio}
                                                </p:column>
												<p:column>
													<f:facet name="header" id="prodStock">Cantidad</f:facet>#{detalle.cantidad}
                                                </p:column>
												<p:column>
													<f:facet name="header" id="prodBodega">Total</f:facet>#{detalle.total}
                                                </p:column>
											</p:dataTable>
										</div>
										<p></p>
										<p>
											<h:outputLabel for="salidaDireccion"
												value="Subtotal: #{facturaDetalleBean.subtotal}"></h:outputLabel>
										</p>
										<p>
											<h:outputLabel for="salidaDireccion"
												value="IVA: #{facturaDetalleBean.iva}"></h:outputLabel>
										</p>
										<h:outputLabel for="salidaDireccion"
											value="Total: #{facturaDetalleBean.totalFinal}"></h:outputLabel>
										<p></p>
										<p:commandButton class="btn btn-primary btn-block"
											value="Facturar"
											style="background: Black;font-family: sans-serif;"
											action="#{facturaDetalleBean.guardarFactura()}"
											update="fa1 fa2 fa3">
										</p:commandButton>
									</h:form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--   Core JS Files   -->
	<script
		src="/PracticaDeLaboratorio04/assets/js/core/jquery.min.js"></script>
	<script
		src="/PracticaDeLaboratorio04/assets/js/core/popper.min.js"></script>
	<script
		src="/PracticaDeLaboratorio04/assets/js/core/bootstrap.min.js"></script>
	<script
		src="/PracticaDeLaboratorio04/assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>

	<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
	<script
		src="/PracticaDeLaboratorio04/assets/js/now-ui-dashboard.min.js?v=1.5.0"
		type="text/javascript"></script>
</h:body>

</html>